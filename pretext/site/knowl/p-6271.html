<!DOCTYPE html>
<html lang="en-US">
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2022-09-27T18:24:51+01:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body>
<h6 class="heading"><span class="type">Paragraph</span></h6>
<p>Computing arguments of \(E_2(h)\) with respect to \(h\) is a little harder, since \(h\) now appears in the arguments of the function \(f\text{.}\) As a consequence, we have to include some partial derivatives.</p>
<div class="displaymath">
\begin{align*}
E_2(h)&amp;=\phi(t_n+h)-y_n-\frac{h}{2}f(t_n,y_n)
-\frac{h}{2}f\Big(t_n+\frac{h}{2},y_n+\frac{h}{2}f(t_n,y_n)\Big) \\
E'_2(h)&amp;=\phi'(t_n+h)-\frac{1}{2}f(t_n,y_n)
-\frac{1}{2}f\Big(t_n+\frac{h}{2},y_n+\frac{h}{2}f(t_n,y_n)\Big) \\
&amp;\hskip2.5in-\frac{h}{2}
\underbrace{\diff{}{h} f\Big(t_n+\frac{h}{2},y_n+\frac{h}{2}f(t_n,y_n)\Big)}_{\text{leave this expression as is for now}} \\
E''_2(h)&amp;=\phi''(t_n+h)
-2\times\frac{1}{2}
\underbrace{\diff{}{h}f\Big(t_n+\frac{h}{2},y_n+\frac{h}{2}f(t_n,y_n)\Big)}_{\text{leave this one too}} \\
&amp;\hskip2.5in-\frac{h}{2}
\underbrace{\frac{\mathrm{d^2}}{\mathrm{d}h^2}f\Big(t_n+\frac{h}{2},y_n+\frac{h}{2}f(t_n,y_n)\Big)}_{\text{and leave this one too}} 
\end{align*}
</div>
<p>Since we only need \(E_2(h)\) and its derivatives at \(h=0\text{,}\) we don't have to compute the \(\frac{\mathrm{d^2 f}}{\mathrm{d}h^2}\) term (thankfully) and we also do not need to compute the \(\diff{f}{h}\) term in \(E_2'\text{.}\) We do, however, need \(\diff{f}{h}\Big|_{h=0}\) for \(E_2''(0)\text{.}\)</p>
<div class="displaymath">
\begin{align*}
E_2(0)&amp;=\phi(t_n)-y_n=0 \\
E'_2(0)&amp;=\phi'(t_n)-\frac{1}{2}f(t_n,y_n)-\frac{1}{2}f(t_n,y_n)=0 \\
E''_2(0)&amp;=\phi''(t_n)-\diff{}{h}
f\Big(t_n+\frac{h}{2},y_n+\frac{h}{2}f(t_n,y_n)\Big)\Big|_{h=0} \\
&amp;=\phi''(t_n)-
\frac{1}{2} f_t\Big(t_n+\frac{h}{2},y_n+\frac{h}{2}f(t_n,y_n)\Big)\Big|_{h=0} \\
&amp;\hskip1.5in -\frac{1}{2} f(t_n,y_n)\, f_y\Big(t_n+\frac{h}{2},y_n+\frac{h}{2}f(t_n,y_n)\Big)\Big|_{h=0} \\
&amp;=\phi''(t_n)- \frac{1}{2}f_t(t_n,y_n)-\frac{1}{2}f_y(t_n,y_n)\, f(t_n,y_n) \\
&amp;=\half\phi''(t_n)\qquad\text{by (E9)}
\end{align*}
</div>
<p>By Taylor, the local truncation error for Euler-2step obeys</p>
<span class="incontext"><a href="ssec_E_E2_local_trunc.html#p-6271">in-context</a></span>
</body>
</html>
