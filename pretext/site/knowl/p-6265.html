<!DOCTYPE html>
<html lang="en-US">
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2022-09-27T18:24:50+01:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body>
<h6 class="heading"><span class="type">Paragraph</span></h6>
<p>The Kutta-Merson process<a knowl="./knowl/fn-280-hidden.html" title="Footnote D.3.13"><sup> 13 </sup></a> uses two variations of the Runge-Kutta method. Each step involves five calculations<a knowl="./knowl/fn-281-hidden.html" title="Footnote D.3.14"><sup> 14 </sup></a>  of \(f\text{:}\)</p>
<div class="displaymath">
\begin{align*}
k_{1,n}&amp;=f(t_n,y_n) \\
k_{2,n}&amp;=f\big(t_n+\tfrac{1}{3}h,y_n+\tfrac{1}{3}hk_{1,n}\big)\\
k_{3,n}&amp;=
f\big(t_n+\tfrac{1}{3}h,y_n+\tfrac{1}{6}hk_{1,n}+\tfrac{1}{6}hk_{2,n}\big) \\
k_{4,n}&amp;=
f\big(t_n+\tfrac{1}{2}h,y_n+\tfrac{1}{8}hk_{1,n}+\tfrac{3}{8}hk_{3,n}\big) \\
k_{5,n}&amp;=
f\big(t_n+h,y_n+\tfrac{1}{2}hk_{1,n}-\tfrac{3}{2}hk_{3,n}+2hk_{4,n}\big)
\end{align*}
</div>
<p>Once these five evaluations have been made, the process generates two approximations for \(y(t_n+h)\text{:}\)</p>
<div class="displaymath">
\begin{align*}
A_{1,n+1}&amp;=y_n+h\left[\tfrac{1}{2}k_{1,n}-\tfrac{3}{2}k_{3,n}+2k_{4,n}\right] \\
A_{2,n+1}&amp;=y_n+h\left[\tfrac{1}{6}k_{1,n}+\tfrac{2}{3}k_{4,n}
+\tfrac{1}{6}k_{5,n}\right]
\end{align*}
</div>
<p>The (signed) error in \(A_{1,n+1}\) is \(\frac{1}{120}h^5K+O(h^6)\) while that in \(A_{2,n+1}\) is \(\frac{1}{720}h^5K+O(h^6)\) with the same constant \(K\text{.}\) So \(A_{1,n+1}-A_{2,n+1} = \frac{5}{720}Kh^5+O(h^6)\) and the unknown constant \(K\) can be determined, to within an error \(O(h)\text{,}\) by</p>
<div class="displaymath">
\begin{equation*}
K=\frac{720}{5\,h^5}(A_{1,n+1}-A_{2,n+1})
\end{equation*}
</div>
<p>and the approximate (signed) error in \(A_{2,n+1}\) and its corresponding rate per unit increase of \(t\) are</p>
<div class="displaymath">
\begin{align*}
E&amp;=\frac{1}{720}K h^5=\frac{1}{5}(A_{1,n+1}-A_{2,n+1}) \\
r=\frac{|E|}{h}&amp;=\frac{1}{720}|K| h^4=\frac{1}{5\,h}\big|A_{1,n+1}-A_{2,n+1}\big|
\end{align*}
</div>
<ul class="disc">
<li>If \(r&gt;\varepsilon\) we redo this step with a new trial step size chosen so that \(\frac{1}{720}|K|(\text{new h})^4\lt\varepsilon\text{,}\) i.e. \(\frac{r}{h^4}(\text{new }h)^4\lt\varepsilon\text{.}\) With our traditional safety factor, we take<div class="displaymath">
\begin{equation*}
\text{new }h=0.9\left(\frac{\varepsilon}{r}\right)^{1/4}\,h
\end{equation*}
</div>
</li>
<li>If \(r\le \varepsilon\) we set \(t_{n+1}=t_n+h\) and \(y_{n+1}=A_{2,n+1}-E\) (since \(E\) is our estimate of the signed error in \(A_{2,n+1}\)) and move on to the next step with trial step size<div class="displaymath">
\begin{equation*}
\text{new }h=0.9\left(\frac{\varepsilon}{r}\right)^{1/4}\,h
\end{equation*}
</div>
</li>
</ul>
<span class="incontext"><a href="ssec_Kutta_Merson.html#p-6265">in-context</a></span>
</body>
</html>
